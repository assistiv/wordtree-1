{"name": "<%=@term%>", "children": [
  <%- terms = @document.terms.find_by_name(@term).preterms.group(:name) %>
  <%- terms.each do |t| %> 
  {"name": "<%= t.name%>", "children": [
    <%- terms2 = t.preterms.group(:name) %>
    <%- terms2.each do |t2| %> 
      {"name": "<%= t2.name%>", "children": [
      <%- terms3 = t2.preterms.group(:name) %>
      <%- terms3.each do |t3| %>
        {"name": "<%=t3.name%>"}<%= ',' if t3 != terms3.last %>
      <%- end %>
      ]}<%= ',' if t2 != terms2.last %>
      <%- end %>
    ]}<%= ',' if t != terms.last %>
  <%- end %>
]}
